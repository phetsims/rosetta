<div class="container">
  <h1>{{=it.title}}</h1>

  <!--show username if available -->
  {{? it.username }}
  <div><p>user: {{=it.username}}</p></div>
  {{?}}

  <h2>{{=it.subtitle}}</h2>
  <table id="stringsTable" style="width:50%">
    <tr>
      <td><strong>English</strong></td>
      <td><strong>{{=it.destinationLanguage}}</strong></td>
    </tr>
    {{=it.stringsTable}}
  </table>
  <button id="testButton" style="font-size:125%;position:relative;left:-300px;top:30px">Test</button>
  <button id="submitButton" style="font-size:125%;position:relative;left:-200px;top:30px">Submit</button>

  <!--data for sim url-->
  <div id="simData" data-sim-url={{=it.simUrl}} data-sim-name={{=it.simName}}></div>

  <script>
    var testButton = document.getElementById( "testButton" );
    testButton.addEventListener( 'click', function() {
      var simUrl = document.getElementById( 'simData' ).getAttribute( 'data-sim-url' );
      var stringPrefix = document.getElementById( 'simData' ).getAttribute( 'data-sim-name' ).replace( /-/g, '_' ).toUpperCase();
      var stringsToReplace = {};
      var table = document.getElementById( 'stringsTable' );
      for ( var i = 1, row; row = table.rows[ i ]; i++ ) {
        var translation = row.cells[ 1 ].children[ 0 ].value;
        if ( translation.length > 0 ) {
          stringsToReplace[ stringPrefix + '/' + row.getAttribute( 'data-string-key' ) ] = translation;
        }
      }
      var win = window.open( simUrl + '?' + 'strings=' + encodeURIComponent( JSON.stringify( stringsToReplace ) ), '_blank' );
      win.focus();
    } );
  </script>
</div><!-- /.container -->
